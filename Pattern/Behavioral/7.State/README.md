# 7. State (Состояние)
__Суть:__
Позволяет объекту изменять поведение при изменении его внутреннего состояния.

Этот шаблон предполагает инкапсуляцию каждого состояния в отдельный класс, что упрощает добавление новых состояний и изменение существующих без непосредственного изменения кода объекта. Этот шаблон полезен, когда объект переходит из одного состояния в другое, и при каждом переходе выполняются определённые действия.

## Задача
>_Нам нужно разработать простую систему светофоров. Система светофоров состоит из трёх состояний: красного, жёлтого и зелёного, и поведение светофора определяется его текущим состоянием._
## Ключевые компоненты паттерна Состояние
* __Контекст:__ Это класс, который имеет состояние и назначает поведение, зависящее от состояния, различным объектам состояния.
* __Состояние:__ Абстрактный базовый класс или интерфейс, определяющий общий интерфейс для всех конкретных состояний. Каждое конкретное состояние реализует определённое поведение, связанное с конкретным состоянием.
* __ConcreteState:__ Это классы, которые наследуются от класса State и предоставляют конкретные реализации для поведения, связанного с определённым состоянием.
## Диаграмма паттерна Состояния
<figure>
    <img src ="/assets/images/Diagram_State.webp" alt = "State">
</figure>


## Пример
```c++
#include <iostream>

class State {
public:
    virtual void handle() = 0;
};

class ConcreteStateA : public State {
public:
    void handle() override { std::cout << "State A\n"; }
};

class ConcreteStateB : public State {
public:
    void handle() override { std::cout << "State B\n"; }
};

class Context {
    State* state;
public:
    Context(State* s) : state(s) {}
    void setState(State* s) { state = s; }
    void request() { state->handle(); }
};

int main() {
    ConcreteStateA stateA;
    ConcreteStateB stateB;

    Context context(&stateA);
    context.request();  // State A

    context.setState(&stateB);
    context.request();  // State B

    return 0;
}
```
## Преимущества шаблона State в C++ Design Patterns
✅ __Чистый код:__ Шаблон проектирования «Состояние» способствует созданию более чистого кода за счёт инкапсуляции поведения каждого состояния в отдельный класс, что делает код более модульным и удобным для поддержки.

✅ __Гибкость:__ Позволяет легко добавлять новые состояния без изменения существующего кода. Каждое состояние независимо и может быть добавлено или изменено без влияния на другие состояния.

✅ __Читабельность:__ Этот шаблон повышает читабельность кода за счёт чёткого структурированного определения переходов между состояниями и связанного с ними поведения.

✅ __Масштабируемость:__ Шаблон хорошо масштабируется по мере увеличения количества состояний и специфичных для каждого состояния действий. Он представляет собой масштабируемое и удобное в обслуживании решение для управления сложными системами с несколькими состояниями.

✅ __Упрощает тестирование:__ Тестирование становится более управляемым, поскольку каждое состояние можно тестировать отдельно. Вы можете сосредоточиться на тестировании конкретных действий, связанных с каждым состоянием, не беспокоясь о взаимодействии с другими состояниями.

## Недостатки шаблона State в паттернах проектирования на C++
❌ __Сложность:__ Шаблон проектирования «Состояние» предполагает использование дополнительных классов, что усложняет кодовую базу, особенно при простых переходах между состояниями.

❌ __Увеличение количества классов:__ Шаблон проектирования «Состояние» может привести к увеличению количества классов, что может оказаться непосильной задачей для небольших проектов.

❌ __Кривая обучения:__ Разработчикам, не знакомым с паттерном «Государство», может быть сложно понять и реализовать его на начальном этапе.

❌ __Накладные расходы:__ При управлении переходами между состояниями могут возникать накладные расходы, которые в определенных ситуациях могут повлиять на производительность.

## Где применяется?
1. Документы (черновик → модерация → опубликован).
2. Игровые персонажи (бег → прыжок → атака).