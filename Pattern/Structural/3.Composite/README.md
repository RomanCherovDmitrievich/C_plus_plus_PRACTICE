# 3. Компоновщик (Composite)

Суть: Позволяет работать с древовидными структурами, где каждый элемент может быть как листом, так и узлом.

Композиционный паттерн — это тип структурного паттерна проектирования, который позволяет объединять объекты в древовидные структуры. Он позволяет клиентам единообразно работать с отдельными объектами и их комбинациями.

## Задача
>_Как создать структуру объектов, в которой к отдельным объектам и группам объектов применяется одинаковый подход? Прямое управление коллекцией таких объектов может оказаться сложной задачей, особенно если они имеют разные операции и поведение._

## Ключевые компоненты паттерна Компоновщик
1. __Компонент:__
Базовый класс/интерфейс с общими операциями.
2. __Лист:__
Представляет отдельные объекты (например, одну страницу).
3. __Составной элемент:__
Представляет собой группу компонентов (например, копию страниц). Он может добавлять, удалять дочерние элементы и управлять ими.

## Диаграмма паттерна Компоновщик
<figure>
    <img src ="/assets/images/Diagram_Composite.png" alt = "Composite">
</figure>

## Пример
```c++
#include <iostream>
#include <vector>
using namespace std;

class PageObject {
public:
    virtual void Add(PageObject a) {}
    virtual void Remove() {}
    virtual void Delete(PageObject a) {}
};

class Page : public PageObject {
public:
    void Add(PageObject a)
    {
        cout << "something is added to the page" << endl;
    }
    void Remove()
    {
        cout << "something is removed from the page"
             << endl;
    }
    void Delete(PageObject a)
    {
        cout << "something is deleted from page " << endl;
    }
};

class Copy : public PageObject {
    vector<PageObject> copyPages;

public:
    void AddElement(PageObject a)
    {
        copyPages.push_back(a);
    }

    void Add(PageObject a)
    {
        cout << "something is added to the copy" << endl;
    }
    void Remove()
    {
        cout << "something is removed from the copy"
             << endl;
    }
    void Delete(PageObject a)
    {
        cout << "something is deleted from the copy";
    }
};

int main()
{
    Page a;
    Page b;
    Copy allcopy;
    allcopy.AddElement(a);
    allcopy.AddElement(b);

    allcopy.Add(a);
    a.Add(b);

    allcopy.Remove();
    b.Remove();

    return 0;
}
```

## Преимущества шаблона проектирования Компоновщик
✅ __Упрощение клиентского кода:__ Клиент работает с FileSystemComponent, не зная, файл это или директория.

✅ __Гибкость структуры:__ Легко добавлять новые типы компонентов (например, SymLink для символических ссылок).

✅ __Рекурсивные операции:__ Можно выполнять операции над всей иерархией (например, поиск, подсчёт размера).

## Недостатки шаблона проектирования Компоновщик
❌ __Нарушение принципа единой ответственности:__ Классы компонентов могут стать слишком сложными, если совмещают логику листьев и узлов.

❌ __Ограничения на типы:__ Не все операции имеют смысл для листьев (например, add() для файла).

❌ __Проблемы с производительностью:__ Рекурсивные вызовы могут быть медленными для очень больших деревьев.

## Когда использовать?
1. Вы хотите представить в своей системе иерархию «часть-целое».
2. Вы хотите, чтобы клиенты одинаково относились к отдельным объектам и композициям.
3. Структура может быть рекурсивной, то есть компоненты могут иметь другие компоненты в качестве дочерних.